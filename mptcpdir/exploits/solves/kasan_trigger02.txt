[  367.822343] ==================================================================
[  367.825409] BUG: KASAN: use-after-free in ip_queue_xmit+0x15ef/0x1b20 at addr ffff880113c1a9dc
[  367.826738] Read of size 1 by task connect_ip_opti/2096
[  367.827357] CPU: 0 PID: 2096 Comm: connect_ip_opti Tainted: G    B   W       4.9.169+ #8
[  367.828246] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-2.fc32 04/01/2014
[  367.829245]  ffff88011ac073c0 ffffffff81b86b04 ffff88011a803800 ffff880113c1a9c0
[  367.830046]  ffff880113c1aa00 ffff88011608a280 ffff880113c1a9c0 ffff88011ac073e8
[  367.830874]  ffffffff8150245c ffff88011ac07470 ffff880113c1a9c0 ffff88011a803800
[  367.831699] Call Trace:
[  367.831979]  <IRQ> 
[  367.832219]  [<ffffffff81b86b04>] dump_stack+0xba/0x116
[  367.832813]  [<ffffffff8150245c>] kasan_object_err+0x1c/0x50
[  367.833431]  [<ffffffff8152b872>] kasan_report_error.cold+0x2b1/0x4d4
[  367.834093]  [<ffffffff82e4e8cd>] ? mptcp_handle_options+0x92d/0x1590
[  367.834744]  [<ffffffff82b247df>] ? ip_queue_xmit+0x15ef/0x1b20
[  367.835290]  [<ffffffff81502780>] __asan_report_load1_noabort+0x50/0x60
[  367.835871]  [<ffffffff82b247df>] ? ip_queue_xmit+0x15ef/0x1b20
[  367.836423]  [<ffffffff82b247df>] ip_queue_xmit+0x15ef/0x1b20
[  367.836976]  [<ffffffff82b2322e>] ? ip_queue_xmit+0x3e/0x1b20
[  367.837535]  [<ffffffff82bbd16c>] ? __tcp_v4_send_check+0x1cc/0x360
[  367.838117]  [<ffffffff82b8f07f>] __tcp_transmit_skb+0x136f/0x2a10
[  367.838660]  [<ffffffff82b8dd10>] ? tcp_established_options+0x560/0x560
[  367.839256]  [<ffffffff81501838>] ? kasan_unpoison_shadow+0x38/0x50
[  367.839814]  [<ffffffff814f9faf>] ? trace_kmalloc_node+0x4f/0x180
[  367.840387]  [<ffffffff811af5f4>] ? sched_clock_cpu+0xe4/0x170
[  367.840918]  [<ffffffff82985251>] ? __alloc_skb+0x3c1/0x4d0
[  367.841392]  [<ffffffff82ba4fc0>] tcp_send_active_reset+0x390/0x5b0
[  367.841938]  [<ffffffff82e4e8cd>] mptcp_handle_options+0x92d/0x1590
[  367.842491]  [<ffffffff82b7acbc>] tcp_validate_incoming+0x9cc/0x1570
[  367.843067]  [<ffffffff811f3210>] ? trace_hardirqs_on+0x10/0x10
[  367.843566]  [<ffffffff82a1e000>] ? sk_filter_trim_cap+0x1e0/0x6c0
[  367.844069]  [<ffffffff82b822a2>] tcp_rcv_established+0x422/0x2160
[  367.844555]  [<ffffffff82a1dedf>] ? sk_filter_trim_cap+0xbf/0x6c0
[  367.845027]  [<ffffffff82a1df0c>] ? sk_filter_trim_cap+0xec/0x6c0
[  367.845534]  [<ffffffff82b5a07b>] ? tcp_parse_md5sig_option+0xbb/0x160
[  367.846087]  [<ffffffff82b81e80>] ? tcp_data_queue+0x1e10/0x1e10
[  367.846592]  [<ffffffff82bc13c9>] ? tcp_v4_rcv+0x3369/0x3af0
[  367.847103]  [<ffffffff82bba350>] tcp_v4_do_rcv+0x610/0xa70
[  367.847606]  [<ffffffff82bc1b11>] tcp_v4_rcv+0x3ab1/0x3af0
[  367.848106]  [<ffffffff82c8ae04>] ? nf_nat_ipv4_fn+0xd4/0x680
[  367.848610]  [<ffffffff82c98e00>] ? iptable_nat_ipv4_fn+0x40/0x40
[  367.849128]  [<ffffffff82b0a4cd>] ip_local_deliver_finish+0x25d/0xa70
[  367.849626]  [<ffffffff82b0a3a9>] ? ip_local_deliver_finish+0x139/0xa70
[  367.850150]  [<ffffffff82b0c8de>] ip_local_deliver+0x1be/0x4c0
[  367.850616]  [<ffffffff82b0c919>] ? ip_local_deliver+0x1f9/0x4c0
[  367.851109]  [<ffffffff82b0c720>] ? ip_call_ra_chain+0x540/0x540
[  367.851545]  [<ffffffff811f3202>] ? trace_hardirqs_on+0x2/0x10
[  367.851974]  [<ffffffff82b0a270>] ? inet_del_offload+0x40/0x40
[  367.852393]  [<ffffffff82b0b1f1>] ip_rcv_finish+0x511/0x1500
[  367.852816]  [<ffffffff82b0d543>] ip_rcv+0x963/0x1060
[  367.853195]  [<ffffffff82b0d621>] ? ip_rcv+0xa41/0x1060
[  367.853594]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.854048]  [<ffffffff82b0ace0>] ? ip_local_deliver_finish+0xa70/0xa70
[  367.854548]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.854988]  [<ffffffff829c4b6e>] __netif_receive_skb_core+0xd8e/0x28f0
[  367.855485]  [<ffffffff829c3de0>] ? netif_schedule_queue+0x200/0x200
[  367.855924]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  367.856346]  [<ffffffff829c66fa>] __netif_receive_skb+0x2a/0x170
[  367.856792]  [<ffffffff829c6a00>] process_backlog+0x1c0/0x5c0
[  367.857228]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  367.857675]  [<ffffffff829d06cd>] net_rx_action+0x38d/0xc50
[  367.858085]  [<ffffffff812290b7>] ? handle_edge_irq+0x347/0xa70
[  367.858504]  [<ffffffff829d0340>] ? sk_busy_loop+0x970/0x970
[  367.858947]  [<ffffffff831fd83c>] ? do_softirq_own_stack+0x1c/0x30
[  367.859401]  [<ffffffff83202f8a>] __do_softirq+0x2aa/0x925
[  367.859789]  [<ffffffff831fd83c>] do_softirq_own_stack+0x1c/0x30
[  367.860215]  <EOI> 
[  367.860357]  [<ffffffff8111f5f5>] do_softirq+0x75/0xb0
[  367.860752]  [<ffffffff82b3efbc>] ? inet_csk_listen_stop+0x20c/0xa60
[  367.861230]  [<ffffffff8111f6ce>] __local_bh_enable_ip+0x9e/0xc0
[  367.861662]  [<ffffffff82b3efdf>] inet_csk_listen_stop+0x22f/0xa60
[  367.862103]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  367.862506]  [<ffffffff82b58fb6>] tcp_close+0xde6/0x1320
[  367.862860]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  367.863268]  [<ffffffff82c14992>] inet_release+0xf2/0x1c0
[  367.863690]  [<ffffffff8295dae6>] sock_release+0x96/0x1c0
[  367.864072]  [<ffffffff8295dc26>] sock_close+0x16/0x20
[  367.864437]  [<ffffffff8153c8b9>] __fput+0x279/0x720
[  367.864778]  [<ffffffff8153cde6>] ____fput+0x16/0x20
[  367.865155]  [<ffffffff81170847>] task_work_run+0x117/0x190
[  367.865553]  [<ffffffff81005254>] exit_to_usermode_loop+0x104/0x120
[  367.866030]  [<ffffffff810057ce>] syscall_return_slowpath+0x21e/0x4c0
[  367.866527]  [<ffffffff8152da10>] ? filp_close+0x150/0x150
[  367.866927]  [<ffffffff81005c4e>] do_syscall_64+0x1de/0x2f0
[  367.867348]  [<ffffffff831fc853>] entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  367.867837] Object at ffff880113c1a9c0, in cache kmalloc-64 size: 64
[  367.868292] Allocated:
[  367.868470] PID = 2096
[  367.868659]  save_stack_trace+0x16/0x20
[  367.868948]  save_stack+0x45/0xc0
[  367.869182]  kasan_kmalloc+0xce/0xf0
[  367.869441]  __kmalloc+0x13d/0x220
[  367.869673]  kzalloc.constprop.0+0x1b/0x30
[  367.869969]  ip_options_get_from_user+0x37/0xe0
[  367.870286]  do_ip_setsockopt.constprop.0+0x1a3/0x3850
[  367.870636]  ip_setsockopt+0x3b/0xb0
[  367.870881]  tcp_setsockopt+0x8a/0xe0
[  367.871158]  sock_common_setsockopt+0x9a/0xe0
[  367.871454]  SyS_setsockopt+0x141/0x210
[  367.871715]  do_syscall_64+0x1ac/0x2f0
[  367.871979]  entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  367.872313] Freed:
[  367.872454] PID = 0
[  367.872620]  save_stack_trace+0x16/0x20
[  367.872902]  save_stack+0x45/0xc0
[  367.873135]  kasan_slab_free+0x89/0xd0
[  367.873415]  kfree+0xf0/0x2d0
[  367.873646]  rcu_process_callbacks+0x8e2/0xd90
[  367.873962]  __do_softirq+0x2aa/0x925
[  367.874251] Memory state around the buggy address:
[  367.874601]  ffff880113c1a880: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  367.875087]  ffff880113c1a900: fb fb fb fb fb fb fb fb fc fc fc fc 00 00 00 00
[  367.875610] >ffff880113c1a980: 04 fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
[  367.876118]                                                     ^
[  367.876527]  ffff880113c1aa00: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  367.877021]  ffff880113c1aa80: 00 00 00 00 00 00 fc fc fc fc fc fc fb fb fb fb
[  367.877539] ==================================================================
[  367.878112] ==================================================================
[  367.878764] BUG: KASAN: use-after-free in ip_queue_xmit+0x15f9/0x1b20 at addr ffff880113c1a9d8
[  367.879567] Read of size 1 by task connect_ip_opti/2096
[  367.880063] CPU: 0 PID: 2096 Comm: connect_ip_opti Tainted: G    B   W       4.9.169+ #8
[  367.880818] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-2.fc32 04/01/2014
[  367.881635]  ffff88011ac073c0 ffffffff81b86b04 ffff88011a803800 ffff880113c1a9c0
[  367.882383]  ffff880113c1aa00 ffff88011608a280 ffff880113c1a9c0 ffff88011ac073e8
[  367.883132]  ffffffff8150245c ffff88011ac07470 ffff880113c1a9c0 ffff88011a803800
[  367.883879] Call Trace:
[  367.884119]  <IRQ> 
[  367.884309]  [<ffffffff81b86b04>] du[  373.923905] serial8250: too much work for irq4
mp_stack+0xba/0x116
[  367.884801]  [<ffffffff8150245c>] kasan_object_err+0x1c/0x50
[  367.885351]  [<ffffffff8152b872>] kasan_report_error.cold+0x2b1/0x4d4
[  367.885967]  [<ffffffff82b247e9>] ? ip_queue_xmit+0x15f9/0x1b20
[  367.886529]  [<ffffffff81502780>] __asan_report_load1_noabort+0x50/0x60
[  367.887148]  [<ffffffff82b247e9>] ? ip_queue_xmit+0x15f9/0x1b20
[  367.887712]  [<ffffffff82b247e9>] ip_queue_xmit+0x15f9/0x1b20
[  367.888260]  [<ffffffff82b2322e>] ? ip_queue_xmit+0x3e/0x1b20
[  367.888797]  [<ffffffff82bbd16c>] ? __tcp_v4_send_check+0x1cc/0x360
[  367.889382]  [<ffffffff82b8f07f>] __tcp_transmit_skb+0x136f/0x2a10
[  367.889966]  [<ffffffff82b8dd10>] ? tcp_established_options+0x560/0x560
[  367.890573]  [<ffffffff81501838>] ? kasan_unpoison_shadow+0x38/0x50
[  367.891166]  [<ffffffff814f9faf>] ? trace_kmalloc_node+0x4f/0x180
[  367.891740]  [<ffffffff811af5f4>] ? sched_clock_cpu+0xe4/0x170
[  367.892296]  [<ffffffff82985251>] ? __alloc_skb+0x3c1/0x4d0
[  367.892813]  [<ffffffff82ba4fc0>] tcp_send_active_reset+0x390/0x5b0
[  367.893404]  [<ffffffff82e4e8cd>] mptcp_handle_options+0x92d/0x1590
[  367.893993]  [<ffffffff82b7acbc>] tcp_validate_incoming+0x9cc/0x1570
[  367.894592]  [<ffffffff811f3210>] ? trace_hardirqs_on+0x10/0x10
[  367.895155]  [<ffffffff82a1e000>] ? sk_filter_trim_cap+0x1e0/0x6c0
[  367.895696]  [<ffffffff82b822a2>] tcp_rcv_established+0x422/0x2160
[  367.896107]  [<ffffffff82a1dedf>] ? sk_filter_trim_cap+0xbf/0x6c0
[  367.896522]  [<ffffffff82a1df0c>] ? sk_filter_trim_cap+0xec/0x6c0
[  367.896921]  [<ffffffff82b5a07b>] ? tcp_parse_md5sig_option+0xbb/0x160
[  367.897361]  [<ffffffff82b81e80>] ? tcp_data_queue+0x1e10/0x1e10
[  367.897754]  [<ffffffff82bc13c9>] ? tcp_v4_rcv+0x3369/0x3af0
[  367.898128]  [<ffffffff82bba350>] tcp_v4_do_rcv+0x610/0xa70
[  367.898504]  [<ffffffff82bc1b11>] tcp_v4_rcv+0x3ab1/0x3af0
[  367.898864]  [<ffffffff82c8ae04>] ? nf_nat_ipv4_fn+0xd4/0x680
[  367.899254]  [<ffffffff82c98e00>] ? iptable_nat_ipv4_fn+0x40/0x40
[  367.899657]  [<ffffffff82b0a4cd>] ip_local_deliver_finish+0x25d/0xa70
[  367.900080]  [<ffffffff82b0a3a9>] ? ip_local_deliver_finish+0x139/0xa70
[  367.900524]  [<ffffffff82b0c8de>] ip_local_deliver+0x1be/0x4c0
[  367.900904]  [<ffffffff82b0c919>] ? ip_local_deliver+0x1f9/0x4c0
[  367.901310]  [<ffffffff82b0c720>] ? ip_call_ra_chain+0x540/0x540
[  367.901711]  [<ffffffff811f3202>] ? trace_hardirqs_on+0x2/0x10
[  367.902097]  [<ffffffff82b0a270>] ? inet_del_offload+0x40/0x40
[  367.902494]  [<ffffffff82b0b1f1>] ip_rcv_finish+0x511/0x1500
[  367.902863]  [<ffffffff82b0d543>] ip_rcv+0x963/0x1060
[  367.903205]  [<ffffffff82b0d621>] ? ip_rcv+0xa41/0x1060
[  367.903560]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.903956]  [<ffffffff82b0ace0>] ? ip_local_deliver_finish+0xa70/0xa70
[  367.904399]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.904795]  [<ffffffff829c4b6e>] __netif_receive_skb_core+0xd8e/0x28f0
[  367.905240]  [<ffffffff829c3de0>] ? netif_schedule_queue+0x200/0x200
[  367.905661]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  367.906056]  [<ffffffff829c66fa>] __netif_receive_skb+0x2a/0x170
[  367.906465]  [<ffffffff829c6a00>] process_backlog+0x1c0/0x5c0
[  367.906843]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  367.907247]  [<ffffffff829d06cd>] net_rx_action+0x38d/0xc50
[  367.907617]  [<ffffffff812290b7>] ? handle_edge_irq+0x347/0xa70
[  367.908008]  [<ffffffff829d0340>] ? sk_busy_loop+0x970/0x970
[  367.908392]  [<ffffffff831fd83c>] ? do_softirq_own_stack+0x1c/0x30
[  367.908798]  [<ffffffff83202f8a>] __do_softirq+0x2aa/0x925
[  367.909167]  [<ffffffff831fd83c>] do_softirq_own_stack+0x1c/0x30
[  367.909569]  <EOI> 
[  367.909708]  [<ffffffff8111f5f5>] do_softirq+0x75/0xb0
[  367.910057]  [<ffffffff82b3efbc>] ? inet_csk_listen_stop+0x20c/0xa60
[  367.910487]  [<ffffffff8111f6ce>] __local_bh_enable_ip+0x9e/0xc0
[  367.910884]  [<ffffffff82b3efdf>] inet_csk_listen_stop+0x22f/0xa60
[  367.911300]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  367.911673]  [<ffffffff82b58fb6>] tcp_close+0xde6/0x1320
[  367.912024]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  367.912406]  [<ffffffff82c14992>] inet_release+0xf2/0x1c0
[  367.912763]  [<ffffffff8295dae6>] sock_release+0x96/0x1c0
[  367.913125]  [<ffffffff8295dc26>] sock_close+0x16/0x20
[  367.913478]  [<ffffffff8153c8b9>] __fput+0x279/0x720
[  367.913808]  [<ffffffff8153cde6>] ____fput+0x16/0x20
[  367.914164]  [<ffffffff81170847>] task_work_run+0x117/0x190
[  367.914547]  [<ffffffff81005254>] exit_to_usermode_loop+0x104/0x120
[  367.914989]  [<ffffffff810057ce>] syscall_return_slowpath+0x21e/0x4c0
[  367.915427]  [<ffffffff8152da10>] ? filp_close+0x150/0x150
[  367.915792]  [<ffffffff81005c4e>] do_syscall_64+0x1de/0x2f0
[  367.916166]  [<ffffffff831fc853>] entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  367.916620] Object at ffff880113c1a9c0, in cache kmalloc-64 size: 64
[  367.917029] Allocated:
[  367.917196] PID = 2096
[  367.917367]  save_stack_trace+0x16/0x20
[  367.917625]  save_stack+0x45/0xc0
[  367.917855]  kasan_kmalloc+0xce/0xf0
[  367.918094]  __kmalloc+0x13d/0x220
[  367.918330]  kzalloc.constprop.0+0x1b/0x30
[  367.918600]  ip_options_get_from_user+0x37/0xe0
[  367.918911]  do_ip_setsockopt.constprop.0+0x1a3/0x3850
[  367.919262]  ip_setsockopt+0x3b/0xb0
[  367.919492]  tcp_setsockopt+0x8a/0xe0
[  367.919743]  sock_common_setsockopt+0x9a/0xe0
[  367.920033]  SyS_setsockopt+0x141/0x210
[  367.920303]  do_syscall_64+0x1ac/0x2f0
[  367.920555]  entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  367.920885] Freed:
[  367.921024] PID = 0
[  367.921174]  save_stack_trace+0x16/0x20
[  367.921438]  save_stack+0x45/0xc0
[  367.921667]  kasan_slab_free+0x89/0xd0
[  367.921917]  kfree+0xf0/0x2d0
[  367.922128]  rcu_process_callbacks+0x8e2/0xd90
[  367.922433]  __do_softirq+0x2aa/0x925
[  367.922671] Memory state around the buggy address:
[  367.922989]  ffff880113c1a880: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  367.923477]  ffff880113c1a900: fb fb fb fb fb fb fb fb fc fc fc fc 00 00 00 00
[  367.923947] >ffff880113c1a980: 04 fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
[  367.924424]                                                     ^
[  367.924824]  ffff880113c1aa00: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  367.925307]  ffff880113c1aa80: 00 00 00 00 00 00 fc fc fc fc fc fc fb fb fb fb
[  367.925777] ==================================================================
[  367.926281] ==================================================================
[  367.926948] BUG: KASAN: use-after-free in ip_queue_xmit+0x15e5/0x1b20 at addr ffff880113c1a9d8
[  367.927746] Read of size 1 by task connect_ip_opti/2096
[  367.928244] CPU: 0 PID: 2096 Comm: connect_ip_opti Tainted: G    B   W       4.9.169+ #8
[  367.928995] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-2.fc32 04/01/2014
[  367.929812]  ffff88011ac073c0 ffffffff81b86b04 ffff88011a803800 ffff880113c1a9c0
[  367.930564]  ffff880113c1aa00 ffff88011608a280 ffff8801188ca4c4 ffff88011ac073e8
[  367.931313]  ffffffff8150245c ffff88011ac07470 ffff880113c1a9c0 ffff88011a803800
[  367.932060] Call Trace:
[  367.932300]  <IRQ> 
[  367.932495]  [<ffffffff81b86b04>] dump_stack+0xba/0x116
[  367.932999]  [<ffffffff8150245c>] kasan_object_err+0x1c/0x50
[  367.933538]  [<ffffffff8152b872>] kasan_report_error.cold+0x2b1/0x4d4
[  367.934143]  [<ffffffff82b247d5>] ? ip_queue_xmit+0x15e5/0x1b20
[  367.934705]  [<ffffffff81502780>] __asan_report_load1_noabort+0x50/0x60
[  367.935334]  [<ffffffff82b247d5>] ? ip_queue_xmit+0x15e5/0x1b20
[  367.935891]  [<ffffffff82b247d5>] ip_queue_xmit+0x15e5/0x1b20
[  367.936436]  [<ffffffff82b2322e>] ? ip_queue_xmit+0x3e/0x1b20
[  367.936976]  [<ffffffff82bbd16c>] ? __tcp_v4_send_check+0x1cc/0x360
[  367.937565]  [<ffffffff82b8f07f>] __tcp_transmit_skb+0x136f/0x2a10
[  367.938148]  [<ffffffff82b8dd10>] ? tcp_established_options+0x560/0x560
[  367.938763]  [<ffffffff81501838>] ? kasan_unpoison_shadow+0x38/0x50
[  367.939255]  [<ffffffff814f9faf>] ? trace_kmalloc_node+0x4[  373.960352] serial8250: too much work for irq4
f/0x180
[  367.939650]  [<ffffffff811af5f4>] ? sched_clock_cpu+0xe4/0x170
[  367.940033]  [<ffffffff82985251>] ? __alloc_skb+0x3c1/0x4d0
[  367.940410]  [<ffffffff82ba4fc0>] tcp_send_active_reset+0x390/0x5b0
[  367.940830]  [<ffffffff82e4e8cd>] mptcp_handle_options+0x92d/0x1590
[  367.941257]  [<ffffffff82b7acbc>] tcp_validate_incoming+0x9cc/0x1570
[  367.941678]  [<ffffffff811f3210>] ? trace_hardirqs_on+0x10/0x10
[  367.942073]  [<ffffffff82a1e000>] ? sk_filter_trim_cap+0x1e0/0x6c0
[  367.942490]  [<ffffffff82b822a2>] tcp_rcv_established+0x422/0x2160
[  367.942897]  [<ffffffff82a1dedf>] ? sk_filter_trim_cap+0xbf/0x6c0
[  367.943314]  [<ffffffff82a1df0c>] ? sk_filter_trim_cap+0xec/0x6c0
[  367.943721]  [<ffffffff82b5a07b>] ? tcp_parse_md5sig_option+0xbb/0x160
[  367.944155]  [<ffffffff82b81e80>] ? tcp_data_queue+0x1e10/0x1e10
[  367.944559]  [<ffffffff82bc13c9>] ? tcp_v4_rcv+0x3369/0x3af0
[  367.944937]  [<ffffffff82bba350>] tcp_v4_do_rcv+0x610/0xa70
[  367.945317]  [<ffffffff82bc1b11>] tcp_v4_rcv+0x3ab1/0x3af0
[  367.945684]  [<ffffffff82c8ae04>] ? nf_nat_ipv4_fn+0xd4/0x680
[  367.946065]  [<ffffffff82c98e00>] ? iptable_nat_ipv4_fn+0x40/0x40
[  367.946480]  [<ffffffff82b0a4cd>] ip_local_deliver_finish+0x25d/0xa70
[  367.946907]  [<ffffffff82b0a3a9>] ? ip_local_deliver_finish+0x139/0xa70
[  367.947358]  [<ffffffff82b0c8de>] ip_local_deliver+0x1be/0x4c0
[  367.947746]  [<ffffffff82b0c919>] ? ip_local_deliver+0x1f9/0x4c0
[  367.948148]  [<ffffffff82b0c720>] ? ip_call_ra_chain+0x540/0x540
[  367.948555]  [<ffffffff811f3202>] ? trace_hardirqs_on+0x2/0x10
[  367.948943]  [<ffffffff82b0a270>] ? inet_del_offload+0x40/0x40
[  367.949341]  [<ffffffff82b0b1f1>] ip_rcv_finish+0x511/0x1500
[  367.949718]  [<ffffffff82b0d543>] ip_rcv+0x963/0x1060
[  367.950053]  [<ffffffff82b0d621>] ? ip_rcv+0xa41/0x1060
[  367.950414]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.950815]  [<ffffffff82b0ace0>] ? ip_local_deliver_finish+0xa70/0xa70
[  367.951267]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.951668]  [<ffffffff829c4b6e>] __netif_receive_skb_core+0xd8e/0x28f0
[  367.952107]  [<ffffffff829c3de0>] ? netif_schedule_queue+0x200/0x200
[  367.952543]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  367.952936]  [<ffffffff829c66fa>] __netif_receive_skb+0x2a/0x170
[  367.953347]  [<ffffffff829c6a00>] process_backlog+0x1c0/0x5c0
[  367.953732]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  367.954134]  [<ffffffff829d06cd>] net_rx_action+0x38d/0xc50
[  367.954512]  [<ffffffff812290b7>] ? handle_edge_irq+0x347/0xa70
[  367.954906]  [<ffffffff829d0340>] ? sk_busy_loop+0x970/0x970
[  367.955295]  [<ffffffff831fd83c>] ? do_softirq_own_stack+0x1c/0x30
[  367.955702]  [<ffffffff83202f8a>] __do_softirq+0x2aa/0x925
[  367.956065]  [<ffffffff831fd83c>] do_softirq_own_stack+0x1c/0x30
[  367.956471]  <EOI> 
[  367.956609]  [<ffffffff8111f5f5>] do_softirq+0x75/0xb0
[  367.956963]  [<ffffffff82b3efbc>] ? inet_csk_listen_stop+0x20c/0xa60
[  367.957396]  [<ffffffff8111f6ce>] __local_bh_enable_ip+0x9e/0xc0
[  367.957793]  [<ffffffff82b3efdf>] inet_csk_listen_stop+0x22f/0xa60
[  367.958208]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  367.958590]  [<ffffffff82b58fb6>] tcp_close+0xde6/0x1320
[  367.958943]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  367.959327]  [<ffffffff82c14992>] inet_release+0xf2/0x1c0
[  367.959685]  [<ffffffff8295dae6>] sock_release+0x96/0x1c0
[  367.960041]  [<ffffffff8295dc26>] sock_close+0x16/0x20
[  367.960395]  [<ffffffff8153c8b9>] __fput+0x279/0x720
[  367.960724]  [<ffffffff8153cde6>] ____fput+0x16/0x20
[  367.961055]  [<ffffffff81170847>] task_work_run+0x117/0x190
[  367.961437]  [<ffffffff81005254>] exit_to_usermode_loop+0x104/0x120
[  367.961851]  [<ffffffff810057ce>] syscall_return_slowpath+0x21e/0x4c0
[  367.962287]  [<ffffffff8152da10>] ? filp_close+0x150/0x150
[  367.962651]  [<ffffffff81005c4e>] do_syscall_64+0x1de/0x2f0
[  367.963034]  [<ffffffff831fc853>] entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  367.963493] Object at ffff880113c1a9c0, in cache kmalloc-64 size: 64
[  367.963923] Allocated:
[  367.964087] PID = 2096
[  367.964263]  save_stack_trace+0x16/0x20
[  367.964523]  save_stack+0x45/0xc0
[  367.964749]  kasan_kmalloc+0xce/0xf0
[  367.964990]  __kmalloc+0x13d/0x220
[  367.965233]  kzalloc.constprop.0+0x1b/0x30
[  367.965508]  ip_options_get_from_user+0x37/0xe0
[  367.965810]  do_ip_setsockopt.constprop.0+0x1a3/0x3850
[  367.966155]  ip_setsockopt+0x3b/0xb0
[  367.966403]  tcp_setsockopt+0x8a/0xe0
[  367.966650]  sock_common_setsockopt+0x9a/0xe0
[  367.966944]  SyS_setsockopt+0x141/0x210
[  367.967206]  do_syscall_64+0x1ac/0x2f0
[  367.967469]  entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  367.967813] Freed:
[  367.967955] PID = 0
[  367.968103]  save_stack_trace+0x16/0x20
[  367.968373]  save_stack+0x45/0xc0
[  367.968599]  kasan_slab_free+0x89/0xd0
[  367.968849]  kfree+0xf0/0x2d0
[  367.969051]  rcu_process_callbacks+0x8e2/0xd90
[  367.969355]  __do_softirq+0x2aa/0x925
[  367.969600] Memory state around the buggy address:
[  367.969917]  ffff880113c1a880: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  367.970404]  ffff880113c1a900: fb fb fb fb fb fb fb fb fc fc fc fc 00 00 00 00
[  367.970889] >ffff880113c1a980: 04 fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
[  367.971377]                                                     ^
[  367.971793]  ffff880113c1aa00: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  367.972280]  ffff880113c1aa80: 00 00 00 00 00 00 fc fc fc fc fc fc fb fb fb fb
[  367.972753] ==================================================================
[  367.973261] ==================================================================
[  367.973932] BUG: KASAN: use-after-free in ip_options_build+0x720/0x800 at addr ffff880113c1a9d0
[  367.974735] Read of size 16 by task connect_ip_opti/2096
[  367.975243] CPU: 0 PID: 2096 Comm: connect_ip_opti Tainted: G    B   W       4.9.169+ #8
[  367.975996] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-2.fc32 04/01/2014
[  367.976817]  ffff88011ac07358 ffffffff81b86b04 ffff88011a803800 ffff880113c1a9c0
[  367.977563]  ffff880113c1aa00 000000000f02000a ffff880113c1a9d0 ffff88011ac07380
[  367.978316]  ffffffff8150245c ffff88011ac07410 ffff880113c1a9c0 ffff88011a803800
[  367.979062] Call Trace:
[  367.979302]  <IRQ> 
[  367.979498]  [<ffffffff81b86b04>] dump_stack+0xba/0x116
[  367.980004]  [<ffffffff8150245c>] kasan_object_err+0x1c/0x50
[  367.980540]  [<ffffffff8152b872>] kasan_report_error.cold+0x2b1/0x4d4
[  367.981145]  [<ffffffff831fc5e1>] ? _raw_spin_unlock_irqrestore+0x51/0x60
[  367.981781]  [<ffffffff82b16330>] ? ip_options_build+0x720/0x800
[  367.982351]  [<ffffffff81502544>] __asan_report_load_n_noabort+0x54/0x60
[  367.982974]  [<ffffffff82b16330>] ? ip_options_build+0x720/0x800
[  367.983560]  [<ffffffff82b16330>] ip_options_build+0x720/0x800
[  367.984125]  [<ffffffff81502780>] ? __asan_report_load1_noabort+0x50/0x60
[  367.984769]  [<ffffffff82b23c20>] ip_queue_xmit+0xa30/0x1b20
[  367.985340]  [<ffffffff82b2322e>] ? ip_queue_xmit+0x3e/0x1b20
[  367.985906]  [<ffffffff82bbd16c>] ? __tcp_v4_send_check+0x1cc/0x360
[  367.986520]  [<ffffffff82b8f07f>] __tcp_transmit_skb+0x136f/0x2a10
[  367.987126]  [<ffffffff82b8dd10>] ? tcp_established_options+0x560/0x560
[  367.987673]  [<ffffffff81501838>] ? kasan_unpoison_shadow+0x38/0x50
[  367.988114]  [<ffffffff814f9faf>] ? trace_kmalloc_node+0x4f/0x180
[  367.988560]  [<ffffffff811af5f4>] ? sched_clock_cpu+0xe4/0x170
[  367.988973]  [<ffffffff82985251>] ? __alloc_skb+0x3c1/0x4d0
[  367.989386]  [<ffffffff82ba4fc0>] tcp_send_active_reset+0x390/0x5b0
[  367.989821]  [<ffffffff82e4e8cd>] mptcp_handle_options+0x92d/0x1590
[  367.990279]  [<ffffffff82b7acbc>] tcp_validate_incoming+0x9cc/0x1570
[  367.990713]  [<ffffffff811f3210>] ? trace_hardirqs_on+0x10/0x10
[  367.991119]  [<ffffffff82a1e000>] ? sk_filter_trim_cap+0x1e0/0x6c0
[  367.991556]  [<ffffffff82b822a2>] tcp_rcv_established+0x422/0x2160
[  367.991979]  [<ffffffff82a1dedf>] ? sk_filter_trim_cap+0xbf[  373.997770] serial8250: too much work for irq4
/0x6c0
[  367.992405]  [<ffffffff82a1df0c>] ? sk_filter_trim_cap+0xec/0x6c0
[  367.992823]  [<ffffffff82b5a07b>] ? tcp_parse_md5sig_option+0xbb/0x160
[  367.993285]  [<ffffffff82b81e80>] ? tcp_data_queue+0x1e10/0x1e10
[  367.993683]  [<ffffffff82bc13c9>] ? tcp_v4_rcv+0x3369/0x3af0
[  367.994062]  [<ffffffff82bba350>] tcp_v4_do_rcv+0x610/0xa70
[  367.994442]  [<ffffffff82bc1b11>] tcp_v4_rcv+0x3ab1/0x3af0
[  367.994808]  [<ffffffff82c8ae04>] ? nf_nat_ipv4_fn+0xd4/0x680
[  367.995197]  [<ffffffff82c98e00>] ? iptable_nat_ipv4_fn+0x40/0x40
[  367.995610]  [<ffffffff82b0a4cd>] ip_local_deliver_finish+0x25d/0xa70
[  367.996036]  [<ffffffff82b0a3a9>] ? ip_local_deliver_finish+0x139/0xa70
[  367.996484]  [<ffffffff82b0c8de>] ip_local_deliver+0x1be/0x4c0
[  367.996872]  [<ffffffff82b0c919>] ? ip_local_deliver+0x1f9/0x4c0
[  367.997280]  [<ffffffff82b0c720>] ? ip_call_ra_chain+0x540/0x540
[  367.997679]  [<ffffffff811f3202>] ? trace_hardirqs_on+0x2/0x10
[  367.998068]  [<ffffffff82b0a270>] ? inet_del_offload+0x40/0x40
[  367.998464]  [<ffffffff82b0b1f1>] ip_rcv_finish+0x511/0x1500
[  367.998839]  [<ffffffff82b0d543>] ip_rcv+0x963/0x1060
[  367.999177]  [<ffffffff82b0d621>] ? ip_rcv+0xa41/0x1060
[  367.999533]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  367.999927]  [<ffffffff82b0ace0>] ? ip_local_deliver_finish+0xa70/0xa70
[  368.000369]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  368.000765]  [<ffffffff829c4b6e>] __netif_receive_skb_core+0xd8e/0x28f0
[  368.001207]  [<ffffffff829c3de0>] ? netif_schedule_queue+0x200/0x200
[  368.001635]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  368.002028]  [<ffffffff829c66fa>] __netif_receive_skb+0x2a/0x170
[  368.002435]  [<ffffffff829c6a00>] process_backlog+0x1c0/0x5c0
[  368.002818]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  368.003217]  [<ffffffff829d06cd>] net_rx_action+0x38d/0xc50
[  368.003592]  [<ffffffff812290b7>] ? handle_edge_irq+0x347/0xa70
[  368.003984]  [<ffffffff829d0340>] ? sk_busy_loop+0x970/0x970
[  368.004370]  [<ffffffff831fd83c>] ? do_softirq_own_stack+0x1c/0x30
[  368.004780]  [<ffffffff83202f8a>] __do_softirq+0x2aa/0x925
[  368.005148]  [<ffffffff831fd83c>] do_softirq_own_stack+0x1c/0x30
[  368.005553]  <EOI> 
[  368.005690]  [<ffffffff8111f5f5>] do_softirq+0x75/0xb0
[  368.006043]  [<ffffffff82b3efbc>] ? inet_csk_listen_stop+0x20c/0xa60
[  368.006476]  [<ffffffff8111f6ce>] __local_bh_enable_ip+0x9e/0xc0
[  368.006875]  [<ffffffff82b3efdf>] inet_csk_listen_stop+0x22f/0xa60
[  368.007296]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  368.007670]  [<ffffffff82b58fb6>] tcp_close+0xde6/0x1320
[  368.008020]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  368.008408]  [<ffffffff82c14992>] inet_release+0xf2/0x1c0
[  368.008769]  [<ffffffff8295dae6>] sock_release+0x96/0x1c0
[  368.009132]  [<ffffffff8295dc26>] sock_close+0x16/0x20
[  368.009484]  [<ffffffff8153c8b9>] __fput+0x279/0x720
[  368.009819]  [<ffffffff8153cde6>] ____fput+0x16/0x20
[  368.010156]  [<ffffffff81170847>] task_work_run+0x117/0x190
[  368.010535]  [<ffffffff81005254>] exit_to_usermode_loop+0x104/0x120
[  368.010950]  [<ffffffff810057ce>] syscall_return_slowpath+0x21e/0x4c0
[  368.011385]  [<ffffffff8152da10>] ? filp_close+0x150/0x150
[  368.011751]  [<ffffffff81005c4e>] do_syscall_64+0x1de/0x2f0
[  368.012125]  [<ffffffff831fc853>] entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  368.012582] Object at ffff880113c1a9c0, in cache kmalloc-64 size: 64
[  368.013000] Allocated:
[  368.013168] PID = 2096
[  368.013340]  save_stack_trace+0x16/0x20
[  368.013597]  save_stack+0x45/0xc0
[  368.013822]  kasan_kmalloc+0xce/0xf0
[  368.014063]  __kmalloc+0x13d/0x220
[  368.014307]  kzalloc.constprop.0+0x1b/0x30
[  368.014582]  ip_options_get_from_user+0x37/0xe0
[  368.014886]  do_ip_setsockopt.constprop.0+0x1a3/0x3850
[  368.015237]  ip_setsockopt+0x3b/0xb0
[  368.015483]  tcp_setsockopt+0x8a/0xe0
[  368.015731]  sock_common_setsockopt+0x9a/0xe0
[  368.016027]  SyS_setsockopt+0x141/0x210
[  368.016299]  do_syscall_64+0x1ac/0x2f0
[  368.016553]  entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  368.016882] Freed:
[  368.017022] PID = 0
[  368.017174]  save_stack_trace+0x16/0x20
[  368.017441]  save_stack+0x45/0xc0
[  368.017668]  kasan_slab_free+0x89/0xd0
[  368.017920]  kfree+0xf0/0x2d0
[  368.018129]  rcu_process_callbacks+0x8e2/0xd90
[  368.018432]  __do_softirq+0x2aa/0x925
[  368.018680] Memory state around the buggy address:
[  368.019000]  ffff880113c1a880: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  368.019485]  ffff880113c1a900: fb fb fb fb fb fb fb fb fc fc fc fc 00 00 00 00
[  368.019972] >ffff880113c1a980: 04 fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
[  368.020458]                                                  ^
[  368.020842]  ffff880113c1aa00: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  368.021326]  ffff880113c1aa80: 00 00 00 00 00 00 fc fc fc fc fc fc fb fb fb fb
[  368.021800] ==================================================================
[  368.022306] ==================================================================
[  368.022973] BUG: KASAN: use-after-free in ip_options_build+0x696/0x800 at addr ffff880113c1a9d8
[  368.023789] Read of size 1 by task connect_ip_opti/2096
[  368.024285] CPU: 0 PID: 2096 Comm: connect_ip_opti Tainted: G    B   W       4.9.169+ #8
[  368.025020] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-2.fc32 04/01/2014
[  368.025831]  ffff88011ac07360 ffffffff81b86b04 ffff88011a803800 ffff880113c1a9c0
[  368.026566]  ffff880113c1aa00 000000000f02000a ffff880113c1a9d0 ffff88011ac07388
[  368.027311]  ffffffff8150245c ffff88011ac07410 ffff880113c1a9c0 ffff88011a803800
[  368.028043] Call Trace:
[  368.028277]  <IRQ> 
[  368.028460]  [<ffffffff81b86b04>] dump_stack+0xba/0x116
[  368.028964]  [<ffffffff8150245c>] kasan_object_err+0x1c/0x50
[  368.029521]  [<ffffffff8152b872>] kasan_report_error.cold+0x2b1/0x4d4
[  368.030151]  [<ffffffff82b16330>] ? ip_options_build+0x720/0x800
[  368.030737]  [<ffffffff82b162a6>] ? ip_options_build+0x696/0x800
[  368.031320]  [<ffffffff81502780>] __asan_report_load1_noabort+0x50/0x60
[  368.031966]  [<ffffffff82b162a6>] ? ip_options_build+0x696/0x800
[  368.032563]  [<ffffffff82b162a6>] ip_options_build+0x696/0x800
[  368.033163]  [<ffffffff81502780>] ? __asan_report_load1_noabort+0x50/0x60
[  368.033850]  [<ffffffff82b23c20>] ip_queue_xmit+0xa30/0x1b20
[  368.034429]  [<ffffffff82b2322e>] ? ip_queue_xmit+0x3e/0x1b20
[  368.035012]  [<ffffffff82bbd16c>] ? __tcp_v4_send_check+0x1cc/0x360
[  368.035674]  [<ffffffff82b8f07f>] __tcp_transmit_skb+0x136f/0x2a10
[  368.036326]  [<ffffffff82b8dd10>] ? tcp_established_options+0x560/0x560
[  368.037012]  [<ffffffff81501838>] ? kasan_unpoison_shadow+0x38/0x50
[  368.037534]  [<ffffffff814f9faf>] ? trace_kmalloc_node+0x4f/0x180
[  368.037980]  [<ffffffff811af5f4>] ? sched_clock_cpu+0xe4/0x170
[  368.038423]  [<ffffffff82985251>] ? __alloc_skb+0x3c1/0x4d0
[  368.038835]  [<ffffffff82ba4fc0>] tcp_send_active_reset+0x390/0x5b0
[  368.039317]  [<ffffffff82e4e8cd>] mptcp_handle_options+0x92d/0x1590
[  368.039767]  [<ffffffff82b7acbc>] tcp_validate_incoming+0x9cc/0x1570
[  368.040237]  [<ffffffff811f3210>] ? trace_hardirqs_on+0x10/0x10
[  368.040651]  [<ffffffff82a1e000>] ? sk_filter_trim_cap+0x1e0/0x6c0
[  368.041083]  [<ffffffff82b822a2>] tcp_rcv_established+0x422/0x2160
[  368.041523]  [<ffffffff82a1dedf>] ? sk_filter_trim_cap+0xbf/0x6c0
[  368.041946]  [<ffffffff82a1df0c>] ? sk_filter_trim_cap+0xec/0x6c0
[  368.042381]  [<ffffffff82b5a07b>] ? tcp_parse_md5sig_option+0xbb/0x160
[  368.042838]  [<ffffffff82b81e80>] ? tcp_data_queue+0x1e10/0x1e10
[  368.043275]  [<ffffffff82bc13c9>] ? tcp_v4_rcv+0x3369/0x3af0
[  368.043659]  [<ffffffff82bba350>] tcp_v4_do_rcv+0x610/0xa70
[  368.044039]  [<ffffffff82bc1b11>] tcp_v4_rcv+0x3ab1/0x3af0
[  368.044427]  [<ffffffff82c8ae04>] ? nf_nat_ipv4_fn+0xd4/0x680
[  368.044821]  [<ffffffff82c98e00>] ? iptable_nat_ipv4_fn+0x40/0x40
[  368.045255]  [<ffffffff82b0a4cd>] ip_local_deliver_finish+0x25d/0xa70
[  368.045673]  [<f[  374.035051] serial8250: too much work for irq4
fffffff82b0a3a9>] ? ip_local_deliver_finish+0x139/0xa70
[  368.046107]  [<ffffffff82b0c8de>] ip_local_deliver+0x1be/0x4c0
[  368.046503]  [<ffffffff82b0c919>] ? ip_local_deliver+0x1f9/0x4c0
[  368.046904]  [<ffffffff82b0c720>] ? ip_call_ra_chain+0x540/0x540
[  368.047335]  [<ffffffff811f3202>] ? trace_hardirqs_on+0x2/0x10
[  368.047725]  [<ffffffff82b0a270>] ? inet_del_offload+0x40/0x40
[  368.048135]  [<ffffffff82b0b1f1>] ip_rcv_finish+0x511/0x1500
[  368.048515]  [<ffffffff82b0d543>] ip_rcv+0x963/0x1060
[  368.048851]  [<ffffffff82b0d621>] ? ip_rcv+0xa41/0x1060
[  368.049199]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  368.049604]  [<ffffffff82b0ace0>] ? ip_local_deliver_finish+0xa70/0xa70
[  368.050040]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  368.050473]  [<ffffffff829c4b6e>] __netif_receive_skb_core+0xd8e/0x28f0
[  368.050917]  [<ffffffff829c3de0>] ? netif_schedule_queue+0x200/0x200
[  368.051370]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  368.051757]  [<ffffffff829c66fa>] __netif_receive_skb+0x2a/0x170
[  368.052178]  [<ffffffff829c6a00>] process_backlog+0x1c0/0x5c0
[  368.052576]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  368.053020]  [<ffffffff829d06cd>] net_rx_action+0x38d/0xc50
[  368.053420]  [<ffffffff812290b7>] ? handle_edge_irq+0x347/0xa70
[  368.053813]  [<ffffffff829d0340>] ? sk_busy_loop+0x970/0x970
[  368.054195]  [<ffffffff831fd83c>] ? do_softirq_own_stack+0x1c/0x30
[  368.054613]  [<ffffffff83202f8a>] __do_softirq+0x2aa/0x925
[  368.054980]  [<ffffffff831fd83c>] do_softirq_own_stack+0x1c/0x30
[  368.055390]  <EOI> 
[  368.055527]  [<ffffffff8111f5f5>] do_softirq+0x75/0xb0
[  368.055878]  [<ffffffff82b3efbc>] ? inet_csk_listen_stop+0x20c/0xa60
[  368.056313]  [<ffffffff8111f6ce>] __local_bh_enable_ip+0x9e/0xc0
[  368.056716]  [<ffffffff82b3efdf>] inet_csk_listen_stop+0x22f/0xa60
[  368.057158]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  368.057541]  [<ffffffff82b58fb6>] tcp_close+0xde6/0x1320
[  368.057897]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  368.058288]  [<ffffffff82c14992>] inet_release+0xf2/0x1c0
[  368.058649]  [<ffffffff8295dae6>] sock_release+0x96/0x1c0
[  368.059010]  [<ffffffff8295dc26>] sock_close+0x16/0x20
[  368.059365]  [<ffffffff8153c8b9>] __fput+0x279/0x720
[  368.059695]  [<ffffffff8153cde6>] ____fput+0x16/0x20
[  368.060025]  [<ffffffff81170847>] task_work_run+0x117/0x190
[  368.060403]  [<ffffffff81005254>] exit_to_usermode_loop+0x104/0x120
[  368.060816]  [<ffffffff810057ce>] syscall_return_slowpath+0x21e/0x4c0
[  368.061247]  [<ffffffff8152da10>] ? filp_close+0x150/0x150
[  368.061608]  [<ffffffff81005c4e>] do_syscall_64+0x1de/0x2f0
[  368.061965]  [<ffffffff831fc853>] entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  368.062424] Object at ffff880113c1a9c0, in cache kmalloc-64 size: 64
[  368.062845] Allocated:
[  368.063011] PID = 2096
[  368.063183]  save_stack_trace+0x16/0x20
[  368.063448]  save_stack+0x45/0xc0
[  368.063676]  kasan_kmalloc+0xce/0xf0
[  368.063919]  __kmalloc+0x13d/0x220
[  368.064154]  kzalloc.constprop.0+0x1b/0x30
[  368.064439]  ip_options_get_from_user+0x37/0xe0
[  368.064743]  do_ip_setsockopt.constprop.0+0x1a3/0x3850
[  368.065087]  ip_setsockopt+0x3b/0xb0
[  368.065334]  tcp_setsockopt+0x8a/0xe0
[  368.065584]  sock_common_setsockopt+0x9a/0xe0
[  368.065877]  SyS_setsockopt+0x141/0x210
[  368.066141]  do_syscall_64+0x1ac/0x2f0
[  368.066403]  entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  368.066734] Freed:
[  368.066875] PID = 0
[  368.067026]  save_stack_trace+0x16/0x20
[  368.067298]  save_stack+0x45/0xc0
[  368.067522]  kasan_slab_free+0x89/0xd0
[  368.067775]  kfree+0xf0/0x2d0
[  368.067982]  rcu_process_callbacks+0x8e2/0xd90
[  368.068290]  __do_softirq+0x2aa/0x925
[  368.068533] Memory state around the buggy address:
[  368.068853]  ffff880113c1a880: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  368.069339]  ffff880113c1a900: fb fb fb fb fb fb fb fb fc fc fc fc 00 00 00 00
[  368.069816] >ffff880113c1a980: 04 fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
[  368.070302]                                                     ^
[  368.070701]  ffff880113c1aa00: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  368.071180]  ffff880113c1aa80: 00 00 00 00 00 00 fc fc fc fc fc fc fb fb fb fb
[  368.071659] ==================================================================
[  368.072207] ==================================================================
[  368.072877] BUG: KASAN: use-after-free in ip_options_build+0x18e/0x800 at addr ffff880113c1a9e0
[  368.073702] Read of size 16 by task connect_ip_opti/2096
[  368.074234] CPU: 0 PID: 2096 Comm: connect_ip_opti Tainted: G    B   W       4.9.169+ #8
[  368.075017] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-2.fc32 04/01/2014
[  368.075879]  ffff88011ac07300 ffffffff81b86b04 ffff88011a803800 ffff880113c1a9c0
[  368.076682]  ffff880113c1aa00 ffff880113c1a9e0 ffff880113c1a9d0 ffff88011ac07328
[  368.077476]  ffffffff8150245c ffff88011ac073c8 ffff880113c1a9c0 ffff88011a803800
[  368.078285] Call Trace:
[  368.078550]  <IRQ> 
[  368.078771]  [<ffffffff81b86b04>] dump_stack+0xba/0x116
[  368.079337]  [<ffffffff8150245c>] kasan_object_err+0x1c/0x50
[  368.079927]  [<ffffffff8152b872>] kasan_report_error.cold+0x2b1/0x4d4
[  368.080597]  [<ffffffff831fc5e1>] ? _raw_spin_unlock_irqrestore+0x51/0x60
[  368.081323]  [<ffffffff81502a47>] kasan_report+0x57/0x60
[  368.081892]  [<ffffffff82b15d9e>] ? ip_options_build+0x18e/0x800
[  368.082538]  [<ffffffff82b15d9e>] ? ip_options_build+0x18e/0x800
[  368.083191]  [<ffffffff8150151c>] check_memory_region+0x12c/0x170
[  368.083845]  [<ffffffff81501ab4>] memcpy+0x24/0x50
[  368.084366]  [<ffffffff82b15d9e>] ip_options_build+0x18e/0x800
[  368.084992]  [<ffffffff81502780>] ? __asan_report_load1_noabort+0x50/0x60
[  368.085706]  [<ffffffff82b23c20>] ip_queue_xmit+0xa30/0x1b20
[  368.086313]  [<ffffffff82b2322e>] ? ip_queue_xmit+0x3e/0x1b20
[  368.086917]  [<ffffffff82bbd16c>] ? __tcp_v4_send_check+0x1cc/0x360
[  368.087581]  [<ffffffff82b8f07f>] __tcp_transmit_skb+0x136f/0x2a10
[  368.088043]  [<ffffffff82b8dd10>] ? tcp_established_options+0x560/0x560
[  368.088555]  [<ffffffff81501838>] ? kasan_unpoison_shadow+0x38/0x50
[  368.089023]  [<ffffffff814f9faf>] ? trace_kmalloc_node+0x4f/0x180
[  368.089483]  [<ffffffff811af5f4>] ? sched_clock_cpu+0xe4/0x170
[  368.089899]  [<ffffffff82985251>] ? __alloc_skb+0x3c1/0x4d0
[  368.090309]  [<ffffffff82ba4fc0>] tcp_send_active_reset+0x390/0x5b0
[  368.090760]  [<ffffffff82e4e8cd>] mptcp_handle_options+0x92d/0x1590
[  368.091227]  [<ffffffff82b7acbc>] tcp_validate_incoming+0x9cc/0x1570
[  368.091672]  [<ffffffff811f3210>] ? trace_hardirqs_on+0x10/0x10
[  368.092084]  [<ffffffff82a1e000>] ? sk_filter_trim_cap+0x1e0/0x6c0
[  368.092508]  [<ffffffff82b822a2>] tcp_rcv_established+0x422/0x2160
[  368.092941]  [<ffffffff82a1dedf>] ? sk_filter_trim_cap+0xbf/0x6c0
[  368.093375]  [<ffffffff82a1df0c>] ? sk_filter_trim_cap+0xec/0x6c0
[  368.093788]  [<ffffffff82b5a07b>] ? tcp_parse_md5sig_option+0xbb/0x160
[  368.094243]  [<ffffffff82b81e80>] ? tcp_data_queue+0x1e10/0x1e10
[  368.094655]  [<ffffffff82bc13c9>] ? tcp_v4_rcv+0x3369/0x3af0
[  368.095046]  [<ffffffff82bba350>] tcp_v4_do_rcv+0x610/0xa70
[  368.095445]  [<ffffffff82bc1b11>] tcp_v4_rcv+0x3ab1/0x3af0
[  368.095826]  [<ffffffff82c8ae04>] ? nf_nat_ipv4_fn+0xd4/0x680
[  368.096233]  [<ffffffff82c98e00>] ? iptable_nat_ipv4_fn+0x40/0x40
[  368.096664]  [<ffffffff82b0a4cd>] ip_local_deliver_finish+0x25d/0xa70
[  368.097117]  [<ffffffff82b0a3a9>] ? ip_local_deliver_finish+0x139/0xa70
[  368.097600]  [<ffffffff82b0c8de>] ip_local_deliver+0x1be/0x4c0
[  368.098013]  [<ffffffff82b0c919>] ? ip_local_deliver+0x1f9/0x4c0
[  368.098437]  [<ffffffff82b0c720>] ? ip_call_ra_chain+0x540/0x540
[  368.098836]  [<ffffffff811f3202>] ? trace_hardirqs_on+0x2/0x10
[  368.099232]  [<ffffffff82b0a270>] ? inet_del_offload+0x40/0x40
[  368.099626]  [<ffffffff82b0b1f1>] ip_rcv_finish+0x511/0x1500
[  368.100004]  [<ffffffff82b0d543>] ip_rcv+0x963/0x1060
[[  374.072171] serial8250: too much work for irq4
  368.100375]  [<ffffffff82b0d621>] ? ip_rcv+0xa41/0x1060
[  368.100724]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  368.101141]  [<ffffffff82b0ace0>] ? ip_local_deliver_finish+0xa70/0xa70
[  368.101600]  [<ffffffff82b0cbe0>] ? ip_local_deliver+0x4c0/0x4c0
[  368.102012]  [<ffffffff829c4b6e>] __netif_receive_skb_core+0xd8e/0x28f0
[  368.102472]  [<ffffffff829c3de0>] ? netif_schedule_queue+0x200/0x200
[  368.102903]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  368.103319]  [<ffffffff829c66fa>] __netif_receive_skb+0x2a/0x170
[  368.103727]  [<ffffffff829c6a00>] process_backlog+0x1c0/0x5c0
[  368.104115]  [<ffffffff829c69a6>] ? process_backlog+0x166/0x5c0
[  368.104528]  [<ffffffff829d06cd>] net_rx_action+0x38d/0xc50
[  368.104908]  [<ffffffff812290b7>] ? handle_edge_irq+0x347/0xa70
[  368.105320]  [<ffffffff829d0340>] ? sk_busy_loop+0x970/0x970
[  368.105708]  [<ffffffff831fd83c>] ? do_softirq_own_stack+0x1c/0x30
[  368.106128]  [<ffffffff83202f8a>] __do_softirq+0x2aa/0x925
[  368.106502]  [<ffffffff831fd83c>] do_softirq_own_stack+0x1c/0x30
[  368.106900]  <EOI> 
[  368.107047]  [<ffffffff8111f5f5>] do_softirq+0x75/0xb0
[  368.107426]  [<ffffffff82b3efbc>] ? inet_csk_listen_stop+0x20c/0xa60
[  368.107849]  [<ffffffff8111f6ce>] __local_bh_enable_ip+0x9e/0xc0
[  368.108257]  [<ffffffff82b3efdf>] inet_csk_listen_stop+0x22f/0xa60
[  368.108662]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  368.109030]  [<ffffffff82b58fb6>] tcp_close+0xde6/0x1320
[  368.109392]  [<ffffffff8295dc10>] ? sock_release+0x1c0/0x1c0
[  368.109765]  [<ffffffff82c14992>] inet_release+0xf2/0x1c0
[  368.110128]  [<ffffffff8295dae6>] sock_release+0x96/0x1c0
[  368.110494]  [<ffffffff8295dc26>] sock_close+0x16/0x20
[  368.110839]  [<ffffffff8153c8b9>] __fput+0x279/0x720
[  368.111175]  [<ffffffff8153cde6>] ____fput+0x16/0x20
[  368.111517]  [<ffffffff81170847>] task_work_run+0x117/0x190
[  368.111891]  [<ffffffff81005254>] exit_to_usermode_loop+0x104/0x120
[  368.112339]  [<ffffffff810057ce>] syscall_return_slowpath+0x21e/0x4c0
[  368.112763]  [<ffffffff8152da10>] ? filp_close+0x150/0x150
[  368.113157]  [<ffffffff81005c4e>] do_syscall_64+0x1de/0x2f0
[  368.113533]  [<ffffffff831fc853>] entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  368.113980] Object at ffff880113c1a9c0, in cache kmalloc-64 size: 64
[  368.114406] Allocated:
[  368.114568] PID = 2096
[  368.114732]  save_stack_trace+0x16/0x20
[  368.114993]  save_stack+0x45/0xc0
[  368.115246]  kasan_kmalloc+0xce/0xf0
[  368.115498]  __kmalloc+0x13d/0x220
[  368.115735]  kzalloc.constprop.0+0x1b/0x30
[  368.116017]  ip_options_get_from_user+0x37/0xe0
[  368.116340]  do_ip_setsockopt.constprop.0+0x1a3/0x3850
[  368.116689]  ip_setsockopt+0x3b/0xb0
[  368.116937]  tcp_setsockopt+0x8a/0xe0
[  368.117209]  sock_common_setsockopt+0x9a/0xe0
[  368.117509]  SyS_setsockopt+0x141/0x210
[  368.117766]  do_syscall_64+0x1ac/0x2f0
[  368.118018]  entry_SYSCALL_64_after_swapgs+0x5d/0xdb
[  368.118355] Freed:
[  368.118496] PID = 0
[  368.118642]  save_stack_trace+0x16/0x20
[  368.118898]  save_stack+0x45/0xc0
[  368.119129]  kasan_slab_free+0x89/0xd0
[  368.119389]  kfree+0xf0/0x2d0
[  368.119586]  rcu_process_callbacks+0x8e2/0xd90
[  368.119881]  __do_softirq+0x2aa/0x925
[  368.120130] Memory state around the buggy address:
[  368.120453]  ffff880113c1a880: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  368.120930]  ffff880113c1a900: fb fb fb fb fb fb fb fb fc fc fc fc 00 00 00 00
[  368.121412] >ffff880113c1a980: 04 fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
[  368.121880]                                                        ^
[  368.122304]  ffff880113c1aa00: fc fc fc fc 00 00 00 00 00 00 fc fc fc fc fc fc
[  368.122777]  ffff880113c1aa80: 00 00 00 00 00 00 fc fc fc fc fc fc fb fb fb fb
[  368.123260] ==================================================================
